enum StoryType {
  STATIC
  INTERACTIVE
}

enum SlideType {
  COVER
  CONTENT
  IMAGE
  GAME
  ESSAY
  ENDING
}

model Story {
  id              String    @id @default(cuid())
  islandId        String
  title           String
  subtitle        String?
  coverImage      String?
  backgroundImage String?
  storyType       StoryType
  order           Int       @default(0)

  island            Island             @relation(fields: [islandId], references: [id], onDelete: Cascade)
  staticSlides      StaticSlide[]
  interactiveSlides InteractiveSlide[]
  questions         Question[]
  storyAttempts     StoryAttempt[]

  @@index([islandId])
  @@map("stories")
}

// Static Story/Read mode
model StaticSlide {
  id          String    @id @default(cuid())
  storyId     String
  slideNumber Int
  slideType   SlideType
  imageUrl    String?
  contentText String?

  story Story @relation(fields: [storyId], references: [id], onDelete: Cascade)

  @@index([storyId])
  @@map("static_slide")
}

// Interactive Story/Game mode
model InteractiveSlide {
  id          String    @id @default(cuid())
  storyId     String
  questionId  String?
  slideNumber Int
  slideType   SlideType
  imageUrl    String?
  contentText String?

  story    Story     @relation(fields: [storyId], references: [id], onDelete: Cascade)
  question Question? @relation(fields: [questionId], references: [id], onDelete: SetNull)

  @@index([storyId])
  @@index([questionId])
  @@map("interactive_slide")
}
